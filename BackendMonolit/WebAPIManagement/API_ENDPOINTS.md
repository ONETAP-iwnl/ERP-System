# API Endpoints Documentation

## Ресурсы (Resources)

### Получить все активные ресурсы
- **GET** `/api/Resources`
- **Описание**: Возвращает список всех активных ресурсов

### Получить все неактивные (архивные) ресурсы
- **GET** `/api/Resources/inactive`
- **Описание**: Возвращает список всех неактивных ресурсов

### Получить ресурс по ID
- **GET** `/api/Resources/{id}`
- **Описание**: Возвращает ресурс по указанному ID

### Создать новый ресурс
- **POST** `/api/Resources`
- **Описание**: Создает новый ресурс
- **Тело запроса**: JSON объект Resource

### Обновить ресурс
- **PUT** `/api/Resources/{id}`
- **Описание**: Обновляет существующий ресурс
- **Тело запроса**: JSON объект Resource

### Перевести ресурс в архив
- **PUT** `/api/Resources/{id}/archive`
- **Описание**: Переводит ресурс в архивное состояние

### Удалить ресурс
- **DELETE** `/api/Resources/{id}`
- **Описание**: Удаляет ресурс (только если он не используется)

## Единицы измерения (Units)

### Получить все активные единицы измерения
- **GET** `/api/Units`
- **Описание**: Возвращает список всех активных единиц измерения

### Получить все неактивные единицы измерения
- **GET** `/api/Units/inactive`
- **Описание**: Возвращает список всех неактивных единиц измерения

### Получить единицу измерения по ID
- **GET** `/api/Units/{id}`
- **Описание**: Возвращает единицу измерения по указанному ID

### Создать новую единицу измерения
- **POST** `/api/Units`
- **Описание**: Создает новую единицу измерения
- **Тело запроса**: JSON объект Unit

### Обновить единицу измерения
- **PUT** `/api/Units/{id}`
- **Описание**: Обновляет существующую единицу измерения
- **Тело запроса**: JSON объект Unit

### Перевести единицу измерения в архив
- **PUT** `/api/Units/{id}/archive`
- **Описание**: Переводит единицу измерения в архивное состояние

### Удалить единицу измерения
- **DELETE** `/api/Units/{id}`
- **Описание**: Удаляет единицу измерения (только если она не используется)

## Документы поступления (ReceiptDocuments)

### Получить все документы поступления
- **GET** `/api/ReceiptDocuments`
- **Описание**: Возвращает все документы поступления с их ресурсами

### Получить документ поступления по ID
- **GET** `/api/ReceiptDocuments/{id}`
- **Описание**: Возвращает документ поступления по ID с его ресурсами

### Создать новый документ поступления
- **POST** `/api/ReceiptDocuments`
- **Описание**: Создает новый документ поступления
- **Тело запроса**: JSON объект ReceiptDocument

### Обновить документ поступления
- **PUT** `/api/ReceiptDocuments/{id}`
- **Описание**: Обновляет существующий документ поступления
- **Тело запроса**: JSON объект ReceiptDocument

### Удалить документ поступления
- **DELETE** `/api/ReceiptDocuments/{id}`
- **Описание**: Удаляет документ поступления

### Фильтрация документов поступления (POST)
- **POST** `/api/ReceiptDocuments/filter`
- **Описание**: Фильтрует документы поступления по заданным критериям
- **Тело запроса**: JSON объект ReceiptDocumentFilter

### Фильтрация документов поступления (GET)
- **GET** `/api/ReceiptDocuments/filter`
- **Описание**: Фильтрует документы поступления по query параметрам
- **Параметры**: startDate, endDate, documentNumbers[], resourceIds[], unitIds[]

## Ресурсы поступления (ReceiptResources)

### Получить все ресурсы поступления
- **GET** `/api/ReceiptResources`
- **Описание**: Возвращает все ресурсы поступления

### Получить ресурс поступления по ID
- **GET** `/api/ReceiptResources/{id}`
- **Описание**: Возвращает ресурс поступления по ID

### Получить ресурсы поступления по документу
- **GET** `/api/ReceiptResources/document/{documentId}`
- **Описание**: Возвращает все ресурсы поступления для указанного документа

### Добавить ресурс в документ поступления
- **POST** `/api/ReceiptResources`
- **Описание**: Добавляет ресурс в документ поступления
- **Тело запроса**: JSON объект ReceiptResource

### Обновить ресурс поступления
- **PUT** `/api/ReceiptResources/{id}`
- **Описание**: Обновляет ресурс поступления
- **Тело запроса**: JSON объект ReceiptResource

### Удалить ресурс из документа поступления
- **DELETE** `/api/ReceiptResources/{id}`
- **Описание**: Удаляет ресурс из документа поступления

## Справочные данные (ReferenceData)

### Получить активные ресурсы
- **GET** `/api/ReferenceData/active-resources`
- **Описание**: Возвращает все активные ресурсы для выбора в документах

### Получить активные единицы измерения
- **GET** `/api/ReferenceData/active-units`
- **Описание**: Возвращает все активные единицы измерения для выбора в документах

### Получить все справочные данные
- **GET** `/api/ReferenceData/all`
- **Описание**: Возвращает все активные ресурсы и единицы измерения

## DTO модели данных

### ResourceDto
```json
{
  "id": 1,
  "name": "Название ресурса",
  "isActive": true
}
```

### CreateResourceDto
```json
{
  "name": "Название ресурса",
  "isActive": true
}
```

### UpdateResourceDto
```json
{
  "id": 1,
  "name": "Название ресурса",
  "isActive": true
}
```

### UnitDto
```json
{
  "id": 1,
  "name": "Название единицы измерения",
  "isActive": true
}
```

### CreateUnitDto
```json
{
  "name": "Название единицы измерения",
  "isActive": true
}
```

### UpdateUnitDto
```json
{
  "id": 1,
  "name": "Название единицы измерения",
  "isActive": true
}
```

### ReceiptDocumentDto
```json
{
  "id": 1,
  "number": "ПОСТ-001",
  "date": "2024-01-01",
  "receiptResources": [
    {
      "id": 1,
      "resourceId": 1,
      "resourceName": "Название ресурса",
      "unitId": 1,
      "unitName": "шт",
      "quantity": 100.5,
      "receiptDocumentId": 1
    }
  ]
}
```

### CreateReceiptDocumentDto
```json
{
  "number": "ПОСТ-001",
  "date": "2024-01-01"
}
```

### UpdateReceiptDocumentDto
```json
{
  "id": 1,
  "number": "ПОСТ-001",
  "date": "2024-01-01"
}
```

### ReceiptResourceDto
```json
{
  "id": 1,
  "resourceId": 1,
  "resourceName": "Название ресурса",
  "unitId": 1,
  "unitName": "шт",
  "quantity": 100.5,
  "receiptDocumentId": 1
}
```

### CreateReceiptResourceDto
```json
{
  "resourceId": 1,
  "unitId": 1,
  "quantity": 100.5,
  "receiptDocumentId": 1
}
```

### UpdateReceiptResourceDto
```json
{
  "id": 1,
  "resourceId": 1,
  "unitId": 1,
  "quantity": 100.5,
  "receiptDocumentId": 1
}
```

### ReceiptDocumentFilter
```json
{
  "startDate": "2024-01-01T00:00:00",
  "endDate": "2024-12-31T23:59:59",
  "documentNumbers": ["ПОСТ-001", "ПОСТ-002"],
  "resourceIds": [1, 2, 3],
  "unitIds": [1, 2]
}
```

### ReferenceDataDto
```json
{
  "resources": [
    {
      "id": 1,
      "name": "Название ресурса",
      "isActive": true
    }
  ],
  "units": [
    {
      "id": 1,
      "name": "шт",
      "isActive": true
    }
  ]
}
```

## Бизнес-правила

1. **Уникальность**: Невозможно создать Ресурс, Единицу измерения, Документ поступления/отгрузки, если в системе уже существует сущность того же типа с таким наименованием/номером.

2. **Архивирование**: Невозможно удалить Ресурс, Единицу измерения, если они где-то используются, но можно перевести их в архив.

3. **Выбор в документах**: Сущности в архиве невозможно выбрать при создании/редактировании документов поступления/отгрузки, если только они уже не выбраны в этом документе.

4. **Пустые документы**: Документ поступления может быть пустым, а документ отгрузки не может быть пустым.

5. **Фильтрация**: Фильтрация происходит на сервере. Фильтры по номерам документов, ресурсам и единицам измерения не зависят от выбранного периода.

6. **Отображение наполнения**: Таблицы по документам поступления/отгрузки отображают наполнение документа (ресурсы, которые в них входят). 